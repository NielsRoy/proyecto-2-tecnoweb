import{r as u,h as C,o,w as h,a as p,b as e,u as m,g as H,j as _,c as d,F as c,p as x,t as l,G as N,H as S,S as k,e as D,f as w,n as F,z as V}from"./app-WIpr5u10.js";import{_ as j}from"./AppLayout-D8U70Zno.js";import{P as L}from"./PageFooter-CFCpgnrU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"flex flex-col min-h-screen"},P={class:"flex-1"},U={class:"card rounded-lg shadow-sm p-6 mb-6"},A={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},G=["value"],O={class:"card rounded-lg shadow-sm overflow-hidden"},$={class:"overflow-x-auto"},q={class:"w-full"},z={class:"border-t",style:{"border-color":"var(--color-border)"}},I={class:"px-6 py-4 whitespace-nowrap text-sm"},R={class:"px-6 py-4"},J={class:"px-6 py-4 font-medium"},K={class:"px-6 py-4 text-sm"},Q={class:"px-6 py-4 whitespace-nowrap text-sm"},W=["onClick"],X=["onClick"],Y={key:0,class:"bg-gray-50"},Z={colspan:"5",class:"px-6 py-4"},ee={class:"text-sm"},te={class:"w-full mt-2 border"},se={class:"px-4 py-2"},oe={class:"px-4 py-2"},re={class:"px-4 py-2"},le={class:"px-4 py-2"},ae={key:0},de={key:0,class:"px-6 py-4 border-t",style:{"border-color":"var(--color-border)"}},ne={class:"flex flex-wrap gap-1"},me={__name:"Index",props:{compras:Object,proveedores:Array,filters:Object,visitCount:Number},setup(n){const v=n,f=u(v.filters.proveedor_id||""),y=u(v.filters.fecha_desde||""),b=u(v.filters.fecha_hasta||""),i=u(new Set);function g(){V.get(route("restaurant.compras.index"),{proveedor_id:f.value,fecha_desde:y.value,fecha_hasta:b.value},{preserveState:!0,preserveScroll:!0})}function B(a){i.value.has(a)?i.value.delete(a):i.value.add(a)}function T(a){confirm("¿Estás seguro de que deseas eliminar esta compra? Se validará que el stock lo permita.")&&V.delete(route("restaurant.compras.destroy",a))}function E(a){return new Date(a).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}return(a,t)=>(o(),C(j,null,{default:h(()=>[p(m(H),{title:"Gestión de Compras - Restaurante"}),e("div",M,[e("div",P,[t[13]||(t[13]=e("div",{class:"mb-6"},[e("h1",{class:"text-3xl font-bold",style:{color:"var(--color-text-primary)"}},"Gestión de Compras"),e("p",{class:"text-sm mt-1",style:{color:"var(--color-text-secondary)"}},"Administra las compras de insumos")],-1)),e("div",U,[e("div",A,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"}},"Proveedor",-1)),_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),onChange:g,class:"w-full px-4 py-2 rounded-lg border",style:{"background-color":"var(--color-bg-secondary)","border-color":"var(--color-border)",color:"var(--color-text-primary)"}},[t[3]||(t[3]=e("option",{value:""},"Todos",-1)),(o(!0),d(c,null,x(n.proveedores,s=>(o(),d("option",{key:s.id,value:s.id},l(s.nombre),9,G))),128))],544),[[N,f.value]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"}},"Desde",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),onChange:g,type:"date",class:"w-full px-4 py-2 rounded-lg border",style:{"background-color":"var(--color-bg-secondary)","border-color":"var(--color-border)",color:"var(--color-text-primary)"}},null,544),[[S,y.value]])]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"}},"Hasta",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),onChange:g,type:"date",class:"w-full px-4 py-2 rounded-lg border",style:{"background-color":"var(--color-bg-secondary)","border-color":"var(--color-border)",color:"var(--color-text-primary)"}},null,544),[[S,b.value]])])]),p(m(k),{href:a.route("restaurant.compras.create"),class:"btn-primary px-6 py-2 rounded-lg font-medium transition"},{default:h(()=>t[7]||(t[7]=[D(" + Registrar Compra ")])),_:1},8,["href"])]),e("div",O,[e("div",$,[e("table",q,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Proveedor"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Total"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Fecha/Hora"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",null,[(o(!0),d(c,null,x(n.compras.data,s=>(o(),d(c,{key:s.id},[e("tr",z,[e("td",I,l(s.id),1),e("td",R,l(s.proveedor?s.proveedor.nombre:"Sin proveedor"),1),e("td",J,"Bs. "+l(s.total),1),e("td",K,l(E(s.created_at)),1),e("td",Q,[e("button",{onClick:r=>B(s.id),class:"text-blue-600 hover:text-blue-800 font-medium mr-3"},l(i.value.has(s.id)?"Ocultar":"Ver")+" Detalles ",9,W),p(m(k),{href:a.route("restaurant.compras.edit",s.id),class:"text-green-600 hover:text-green-800 font-medium mr-3"},{default:h(()=>t[8]||(t[8]=[D(" Editar ")])),_:2},1032,["href"]),e("button",{onClick:r=>T(s.id),class:"text-red-600 hover:text-red-800 font-medium"}," Eliminar ",8,X)])]),i.value.has(s.id)?(o(),d("tr",Y,[e("td",Z,[e("div",ee,[t[10]||(t[10]=e("strong",null,"Detalles de la compra:",-1)),e("table",te,[t[9]||(t[9]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"px-4 py-2 text-left"},"Insumo"),e("th",{class:"px-4 py-2 text-left"},"Cantidad"),e("th",{class:"px-4 py-2 text-left"},"Costo Unit."),e("th",{class:"px-4 py-2 text-left"},"Subtotal")])],-1)),e("tbody",null,[(o(!0),d(c,null,x(s.detalles,r=>(o(),d("tr",{key:r.id,class:"border-t"},[e("td",se,l(r.insumo.nombre),1),e("td",oe,l(r.cantidad)+" "+l(r.insumo.unidad_medida),1),e("td",re,"Bs. "+l(r.costo_unitario),1),e("td",le,"Bs. "+l((r.cantidad*r.costo_unitario).toFixed(2)),1)]))),128))])])])])])):w("",!0)],64))),128)),n.compras.data.length===0?(o(),d("tr",ae,t[11]||(t[11]=[e("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-500"}," No se encontraron compras ",-1)]))):w("",!0)])])]),n.compras.links.length>3?(o(),d("div",de,[e("div",ne,[(o(!0),d(c,null,x(n.compras.links,(s,r)=>(o(),C(m(k),{key:r,href:s.url,class:F(["px-3 py-1 rounded",s.active?"btn-primary":"bg-gray-200 hover:bg-gray-300"]),innerHTML:s.label,disabled:!s.url},null,8,["href","class","innerHTML","disabled"]))),128))])])):w("",!0)])]),p(L,{visitCount:n.visitCount},null,8,["visitCount"])])]),_:1}))}};export{me as default};
